\documentclass[a4paper, 12pt]{report}
\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{geometry}
\usepackage{csquotes}
\usepackage[toc,page]{appendix}
\usepackage{titlesec}
\usepackage{listings}
\usepackage{float}
\usepackage[hang,flushmargin]{footmisc} 
\usepackage{makecell}
\usepackage{amsmath}% http://ctan.org/pkg/amsmath
\usepackage[utf8]{inputenc}
\usepackage[default]{cantarell} %% Use option "defaultsans" to use cantarell as sans serif only
\usepackage[T1]{fontenc}

\usepackage{helvet}
\usepackage[eulergreek]{sansmath}
\usepackage{amsfonts}

\usepackage{tikz}
\usetikzlibrary{calc,positioning,shapes,decorations.pathreplacing}
\usetikzlibrary{fit,fadings,shadows,patterns,math}
\usetikzlibrary{shapes.arrows,shapes.geometric}
\usetikzlibrary{arrows,arrows.meta,decorations.markings}
\usetikzlibrary{decorations.pathmorphing}

\usepackage{pgfplots}

\graphicspath{ {./images/} }
\geometry{margin=1.25in}

\newcommand*{\shifttext}[2]{%
  \settowidth{\@tempdima}{#2}%
  \makebox[\@tempdima]{\hspace*{#1}#2}%
}
\newcommand{\fakesection}[1]{%
  \par\refstepcounter{section}% Increase section counter
  \sectionmark{#1}% Add section mark (header)
  \addcontentsline{toc}{section}{\protect\numberline{\thesection}#1}% Add section to ToC
  % Add more content here, if needed.
}
\titleformat{\chapter}[display]
  {\normalfont\bfseries}{}{0pt}{\Large}
\titleformat*{\section}{\large\bfseries}

\renewcommand{\footnoterule}{%
  \kern -3pt
  \hrule width \textwidth height 1pt
  \kern 2pt
}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

\begin{document}

\begin{center}
    \vspace*{2em}
    \normalsize 1. Projekt\\
    \vspace*{1em}
    \normalsize \textbf{\textit{Ableitungsfreie Methoden}}\\
    \vspace*{4em}
    \normalsize im Fach\\
    \vspace*{1em}
    \large Numerische Optimierung\\
    \vspace*{30em}
    \normalsize Mai 2020\\
    \vspace*{1em}
    \normalsize Maximilian Gaul
\end{center}

\thispagestyle{empty}

\newpage

\subsubsection{Aufgabe 1}
Teilintervalle und Funktionswerte des Bisektionsverfahrens aus \lstinline[basicstyle=\ttfamily\color{black}]|Bisektion.m|
für das Minimum von
$$h(x) = e^{-x} + 0.5x^2$$
mit dem Startintervall [0, 1] nach 10 Schritten:\\

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|r}
    \hline
    \textbf{Schritt} & \textbf{Intervall} & \makecell{\textbf{Funktionswert}}\\
    \hline
    1 & [0.00, 1.00] & f(0.50)=0.7315\\
    2 & [0.50, 1.00] & f(0.75)=0.7536\\
    3 & [0.50, 0.75] & f(0.63)=0.7306\\
    4 & [0.50, 0.63] & f(0.56)=0.7280\\
    5 & [0.56, 0.63] & f(0.59)=0.7285\\
    6 & [0.56, 0.59] & f(0.58)=0.7281\\
    7 & [0.56, 0.58] & f(0.57)=0.7280\\
    8 & [0.56, 0.57] & f(0.57)=0.7280\\
    9 & [0.57, 0.57] & f(0.57)=0.7280\\
    10 & [0.57, 0.57] & f(0.57)=0.7280\\
    \hline
  \end{tabular}
  \caption{Die ersten 10 Schritte des Bisektionsverfahrens mit Startintervall [0, 1] für $h(x)$}
\end{figure}

Die Intervallgrenzen und Funktionsauswertungen sind wie folgt verteilt:

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \newcommand*{\scaleFactor}{4}
    \tikzstyle{interval border}=[thin, red];

    \draw[-{Latex}] (-0.5,0) -- (1.25*\scaleFactor,0) node[right] {$x$};
    \draw[-{Latex}] (0,-0.5) -- (0,1.25*\scaleFactor) node[above] {$h(x)$};
    \draw[scale=\scaleFactor, thick, black, domain=-0.25:1.25, smooth, variable=\x] plot ({\x},{exp(-\x) + 0.5*\x^2});

    \foreach \i in {0, 0.50, 0.75, 0.625, 0.5625, 0.5664, 0.5938, 0.5781, 0.5703, 0.5684, 1} {
      \draw[interval border] (\i*\scaleFactor, 0) -- (\i*\scaleFactor, 1.25*\scaleFactor);
    }

    \foreach \x / \y / \i in {0.5/0.7315/1, 0.75/0.7536/2, 0.625/0.7306/3, 0.5625/0.7280/4, 0.5938/0.7285/5, 0.5781/0.7281} {
      \draw (\x*\scaleFactor, \y*\scaleFactor) node[interval border] {x};
    }
  \end{tikzpicture}
  \caption{$h(x)$ mit Intervallgrenzen und Auswertungspunkten des Bisektionsverfahrens}
\end{figure}

\subsubsection{Aufgabe 2}
Siehe \lstinline[basicstyle=\ttfamily\color{black}]|Mutation.m|.

\subsubsection{Aufgabe 3}
Eine Möglichkeit für ein Abbruchkriterium ist die Anzahl an Iterationen, d.h. der Algorithmus stoppt nach einer bestimmten Anzahl an Durchläufen
und gibt den bis dahin berechneten Wert aus. Je nach Funktion und Zufallsvektoren kann die Genauigkeit des Ergebnisses stark schwanken. Während für
eine festgelegte obere Grenze an Durchläufen für eine simple Funktion ein Minimum bereits ausreichend genau bestimmt werden kann, benötigt eine
komplexere Funktion ggf. weitaus mehr Durchläufe. Die Anzahl an Iterationen ist also kein adaptives Kriterium.\par
Weiterhin könnte auch der Betrag aus der Differenz des aktuellen Funktionswertes und des letzten Funktionswertes als Abbruchkriterium funktionieren.
Dabei aktualisiert man die zu überprüfenden Werte nur, sofern eine Verbesserung eingetreten ist (ansonsten wären letzter und aktueller Funktionswert
eventuell gleich). Ist der Differenzbetrag kleiner als eine festgelegte Toleranz, endet der Algorithmus. Typische Werte sind hier z.B. $10^{-4}$ oder
$10^{-8}$.\\\par

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|c|r}
    \hline
    \textbf{Kriterium} & \textbf{Funktion} & \textbf{Genauigkeit} & \textbf{Anzahl Schritte}\\
    \hline
    Differenzbetrag & f & $10^{-6}$ & 4.924.700\\
    Differenzbetrag & f & $10^{-6}$ & 282.179\\
    Differenzbetrag & f & $10^{-6}$ & 24.907\\
    Differenzbetrag & g & $10^{-6}$ & 36.655\\
    Differenzbetrag & g & $10^{-6}$ & 9.758\\
    Differenzbetrag & g & $10^{-6}$ & 882\\
    \hline
  \end{tabular}
  \caption{Einfluss des Zualls auf die Anzahl an Durchläufen für eine Genauigkeit von $10^{-6}$}
\end{figure}

Durch die Wahl des Differenzbetrages kann man vom Zufall profitieren und mit verhältnismäßig wenigen Schritten zu einer guten Genauigkeit kommen.
Wählt man dagegen die Anzahl der Iterationen, muss man ggf. neu rechnen wenn das Ergebnis noch zu ungenau ist:

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|c|r}
    \hline
    \textbf{Abbruchkriterium} & \textbf{Funktion} & \textbf{Genauigkeit} & \textbf{Anzahl Schritte}\\
    \hline
    Anzahl Iterationen & f & $1\cdot 10^{-5}$ & 225.000\\
    Anzahl Iterationen & f & $7\cdot 10^{-6}$ & 225.000\\
    Anzahl Iterationen & f & $2\cdot 10^{-8}$ & 225.000\\
    Anzahl Iterationen & g & $2\cdot 10^{-6}$ & 15.000\\
    Anzahl Iterationen & g & $6\cdot 10^{-7}$ & 15.000\\
    Anzahl Iterationen & g & $1\cdot 10^{-8}$ & 15.000\\
    \hline
  \end{tabular}
  \caption{Einfluss des Zufalls auf die Genauigkeit bei einer gegebenen Anzahl an Durchläufen}
\end{figure}

Der Parameter $\alpha$ bestimmt den Anteil des Zufallsvektors für den Wert von $\hat x$. Kleine Werte von $\alpha$ bedeuten eine höhere Wahrscheinlichkeit,
dass sich der Funktionswert verbessert (die Verbesserung fällt aber möglicherweise kleiner aus) da sich besonders in der Nähe eines Minimums,
bei quadratischen oder Funktionen 4. Grades der Funktionswert stark ändern und man leicht über das Ziel hinaus schießen kann wenn man zu große
Schritte geht (ähnlich wie bei einem Abstiegsverfahren). Falls die Ableitung der Funktion zur Verfügung steht (tut sie hier wahrscheinlich nicht da
das Projekt \textit{Ableitungsfreie Methoden} heißt), könnte man ein Verfahren zur Schrittweitensteuerung implementieren
(z.B. nach Armijo $\varphi(\alpha) := f(x + \alpha r)$).\par

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|c|r|r}
    \hline
    \textbf{Abbruchkriterium} & \textbf{Funktion} & \textbf{Genauigkeit} & $\overline{ \text{\textbf{Anzahl Schritte}} }_{200}$ & \textbf{$\alpha$}\\
    \hline
    Differenzbetrag & f & $10^{-4} $ & 238.992 & 1\\
    Differenzbetrag & f & $10^{-4} $ & 190.980 & 0.5\\
    Differenzbetrag & f & $10^{-4} $ & 19.557 & 0.25\\
    Differenzbetrag & f & $10^{-4} $ & 9.025 & 0.125\\
    Differenzbetrag & g & $10^{-4} $ & 41.688 & 1\\
    Differenzbetrag & g & $10^{-4} $ & 1.878 & 0.5\\
    Differenzbetrag & g & $10^{-4} $ & 1.101 & 0.25\\
    Differenzbetrag & g & $10^{-4} $ & 383 & 0.125\\
    \hline
  \end{tabular}
  \caption{Einfluss von $\alpha$ auf den Durchschnitt von 200 Durchläufen für eine Genauigkeit von $10^{-4}$}
\end{figure}

Zu Beginn von sind die Sprünge der Funktionswerte relativ groß, werden dann aber immer kleiner:

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|r}
    \hline
    \textbf{Funktion} & \textbf{Position} & \textbf{Funktionswert}\\
    \hline
    f & [2.10 3.82] & 101.61\\
    f & [1.85 3.60] & 76.25\\
    f & [2.11 3.55] & 68.41\\
    f & [2.29 3.37] & 50.06\\
    f & [2.02 3.03] & 32.96\\
    f & [2.39 2.68] & 13.39\\
    f & [2.41 2.24] & 9.01\\
    f & [2.42 2.39] & 8.99\\
    f & [2.71 2.37] & 3.44\\
    f & [2.81 2.32] & 2.03\\
    f & [3.20 1.88] & 1.35\\
    f & [3.09 2.12] & 0.80\\
    f & [2.98 1.79] & 0.77\\
    \hline
  \end{tabular}
  \caption{Die ersten Schritte von \lstinline[basicstyle=\ttfamily\color{black}]|Mutation| mit $\alpha = 1$}
\end{figure}

Eine Strategie könnte daher sein, $\alpha$ erst groß zu wählen (z.B. 1) und dann mit jeder erfolgreichen Richtung zu verkleinern.
Das passiert unter der Annahme, das sich der Algorithmus zuerst eine grobe Richtung zum Minimum sucht und danach feinjustiert
(wofür kleinere $\alpha$ besser geeignet sind).

\subsubsection{Aufgabe 4}
Vergleich Rechenaufwand...
\\

\subsubsection{Aufgabe 5}
Beispiel angeben bei dem Abbruchkriterium ungeeignet ist...
\\

\subsubsection{Aufgabe 6}
Berechnet werden die ersten vier Iterationen des Nelder-Mead-Algorithmus von
$$g(x_1, x_2) = 100\cdot(x_2-2)^4 + (x_1 - 2x_2)^2$$
mit den Parametern $n=2$, $\alpha = \frac{1}{2}$, $\beta = 2$ und $\gamma = 1$.
$$x^{(0,0)} = \begin{bmatrix}4\\2\end{bmatrix}, e_1 = \begin{bmatrix}1\\0\end{bmatrix}, e_2 = \begin{bmatrix}0\\1\end{bmatrix}$$
Damit erhält man die Punkte $x^{(0,1)} = \begin{bmatrix}5\\2\end{bmatrix}, x^{(0,2)} = \begin{bmatrix}4\\3\end{bmatrix}$ und den
Startsimplex
$$S_0 = (\begin{bmatrix}4\\2\end{bmatrix}, \begin{bmatrix}5\\2\end{bmatrix}, \begin{bmatrix}4\\3\end{bmatrix})$$

\textbf{k = 0}\\
$$\text{max}\{f(x^{(0,0)}) = 1600, f(x^{(0,1)}) = 8101, f(x^{(0,2)}) = 1604\} = f(x^{(0,1)})$$
$$s_0 = \frac{1}{2}\cdot (\begin{bmatrix}4\\2\end{bmatrix} + \begin{bmatrix}4\\3\end{bmatrix}) = \begin{bmatrix}4\\\frac{5}{2}\end{bmatrix} \text{und } x_0 = x^{(0,1)} = \begin{bmatrix}5\\2\end{bmatrix}$$
\begin{itemize}
\item Reflexion: $\hat x_0 = \begin{bmatrix}4\\\frac{5}{2}\end{bmatrix} + 1\cdot(\begin{bmatrix}4\\\frac{5}{2}\end{bmatrix} - \begin{bmatrix}5\\2\end{bmatrix}) = \begin{bmatrix}3\\3\end{bmatrix}$ mit $f(\hat x_0) = 25$
\item Expansion: $\hat x_0^* = \begin{bmatrix}4\\\frac{5}{2}\end{bmatrix} + 2\cdot (\begin{bmatrix}3\\3\end{bmatrix} - \begin{bmatrix}4\\\frac{5}{2}\end{bmatrix}) = \begin{bmatrix}2\\\frac{7}{2}\end{bmatrix}$ mit $f(\hat x_0^*) = 25$
\end{itemize}

Nach dem 1. Schritt erhält man den Simplex

$$S_1 = (\begin{bmatrix}4\\2\end{bmatrix}, \begin{bmatrix}2\\\frac{7}{2}\end{bmatrix}, \begin{bmatrix}4\\3\end{bmatrix})$$

\textbf{k = 1}\\
$$\text{max}\{f(x^{(1,0)}) = 1600, f(x^{(1,1)}) = 25, f(x^{(1,2)}) = 1604\} = f(x^{(1,2)})$$
$$s_1 = \frac{1}{2}\cdot (\begin{bmatrix}4\\2\end{bmatrix} + \begin{bmatrix}2\\\frac{7}{2}\end{bmatrix}) = \begin{bmatrix}3\\\frac{11}{4}\end{bmatrix} \text{und } x_1 = x^{(1,2)} = \begin{bmatrix}4\\3\end{bmatrix}$$
\begin{itemize}
\item Reflexion: $\hat x_1 = \begin{bmatrix}3\\\frac{11}{4}\end{bmatrix} + 1\cdot(\begin{bmatrix}3\\\frac{11}{4}\end{bmatrix} - \begin{bmatrix}4\\3\end{bmatrix}) = \begin{bmatrix}2\\\frac{5}{2}\end{bmatrix}$ mit $f(\hat x_1) = 9$
\item Expansion: $\hat x_1^* = \begin{bmatrix}3\\\frac{11}{4}\end{bmatrix} + 2\cdot(\begin{bmatrix}2\\\frac{5}{2}\end{bmatrix} - \begin{bmatrix}3\\\frac{11}{4}\end{bmatrix}) = \begin{bmatrix}1\\\frac{9}{4}\end{bmatrix}$ mit $f(\hat x_1^*) = 112.25$
\end{itemize}

Nach dem 2. Schritt erhält man den Simplex

$$S_2 = (\begin{bmatrix}4\\2\end{bmatrix}, \begin{bmatrix}2\\\frac{7}{2}\end{bmatrix}, \begin{bmatrix}2\\\frac{5}{2}\end{bmatrix})$$

\textbf{k = 2}\\
$$\text{max}\{f(x^{(2,0)}) = 1600, f(x^{(2,1)}) = 25, f(x^{(2,2)}) = 9\} = f(x^{(2,0)})$$
$$s_2 = \frac{1}{2}\cdot(\begin{bmatrix}2\\\frac{7}{2}\end{bmatrix} + \begin{bmatrix}2\\\frac{5}{2}\end{bmatrix}) = \begin{bmatrix}2\\3\end{bmatrix} \text{und } x_2 = x^{(2,0)} = \begin{bmatrix}4\\2\end{bmatrix}$$
\begin{itemize}
\item Reflexion: $\hat x_2 = \begin{bmatrix}2\\3\end{bmatrix} + 1\cdot(\begin{bmatrix}2\\3\end{bmatrix} - \begin{bmatrix}4\\2\end{bmatrix}) = \begin{bmatrix}0\\4\end{bmatrix}$ mit $f(\hat x_2) = 1664$
\item Innere Kontraktion: $\hat x_2^* = \begin{bmatrix}2\\3\end{bmatrix} + \frac{1}{2}\cdot(\begin{bmatrix}4\\2\end{bmatrix} - \begin{bmatrix}2\\3\end{bmatrix}) = \begin{bmatrix}3\\\frac{5}{2}\end{bmatrix}$ mit $f(\hat x_2^*) = 104$
\end{itemize}

Nach dem 3. Schritt erhält man den Simplex

$$S_3 = (\begin{bmatrix}3\\\frac{5}{2}\end{bmatrix}, \begin{bmatrix}2\\\frac{7}{2}\end{bmatrix}, \begin{bmatrix}2\\\frac{5}{2}\end{bmatrix})$$

\textbf{k = 3}\\
$$\text{max}\{f(x^{(3,0)}) = 104, f(x^{(3,1)}) = 25, f(x^{(3,2)}) = 9\} = f(x^{(3,0)})$$
$$s_3 = \frac{1}{2}(\begin{bmatrix}2\\\frac{7}{2}\end{bmatrix} + \begin{bmatrix}2\\\frac{5}{2}\end{bmatrix}) = \begin{bmatrix}2\\3\end{bmatrix} \text{und } x_3 = x^{(3,0)} = \begin{bmatrix}3\\\frac{5}{2}\end{bmatrix}$$
\begin{itemize}
\item Reflexion: $\hat x_3 = \begin{bmatrix}2\\3\end{bmatrix} + 1\cdot(\begin{bmatrix}2\\3\end{bmatrix} - \begin{bmatrix}3\\\frac{5}{2}\end{bmatrix}) = \begin{bmatrix}1\\\frac{7}{2}\end{bmatrix}$ mit $f(\hat x_3) = 136$
\item Innere Kontraktion: $\hat x_3^* = \begin{bmatrix}2\\3\end{bmatrix} + \frac{1}{2}\cdot(\begin{bmatrix}3\\\frac{5}{2}\end{bmatrix} - \begin{bmatrix}2\\3\end{bmatrix}) = \begin{bmatrix}\frac{5}{2}\\\frac{11}{4}\end{bmatrix}$ mit $f(\hat x_3^*) = 15.25$
\end{itemize}

Nach dem 4. Schritt erhält man den Simplex

$$S_4 = (\begin{bmatrix}\frac{5}{2}\\\frac{11}{4}\end{bmatrix}, \begin{bmatrix}2\\\frac{7}{2}\end{bmatrix}, \begin{bmatrix}2\\\frac{5}{2}\end{bmatrix})$$

\subsubsection{Aufgabe 7}
Diskussion: Zuverlässigkeit und Rechenaufwand von \textit{Mutation-Selektion} und \textit{Nelder-Mead}


\end{document}