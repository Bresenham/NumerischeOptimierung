\documentclass[a4paper, 12pt]{report}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage[ngerman]{babel}
\usepackage{graphicx}
\usepackage{geometry}
\usepackage{csquotes}
\usepackage[toc,page]{appendix}
\usepackage{titlesec}
\usepackage{listings}
\usepackage{float}
\usepackage[hang,flushmargin]{footmisc} 
\usepackage{makecell}
\usepackage{amsmath}% http://ctan.org/pkg/amsmath

\usepackage[default]{cantarell} %% Use option "defaultsans" to use cantarell as sans serif only
\usepackage{hyperref}
\usepackage{helvet}
\usepackage[eulergreek]{sansmath}
\usepackage{amsfonts}
\usepackage{movie15}
\usepackage{url}
\usepackage{lscape}
\usepackage{changepage}
\usepackage[usenames,dvipsnames]{color}
\usepackage{matlab-prettifier}
\lstset{style=Matlab-editor}

\usepackage{tikz}
\usetikzlibrary{calc,positioning,shapes,decorations.pathreplacing}
\usetikzlibrary{fit,fadings,shadows,patterns,math}
\usetikzlibrary{shapes.arrows,shapes.geometric}
\usetikzlibrary{arrows,arrows.meta,decorations.markings}
\usetikzlibrary{decorations.pathmorphing}

\graphicspath{ {./images/} }
\geometry{margin=1.25in}

\newcommand*{\shifttext}[2]{%
  \settowidth{\@tempdima}{#2}%
  \makebox[\@tempdima]{\hspace*{#1}#2}%
}
\newcommand{\fakesection}[1]{%
  \par\refstepcounter{section}% Increase section counter
  \sectionmark{#1}% Add section mark (header)
  \addcontentsline{toc}{section}{\protect\numberline{\thesection}#1}% Add section to ToC
  % Add more content here, if needed.
}
\titleformat{\chapter}[display]
  {\normalfont\bfseries}{}{0pt}{\Large}
\titleformat*{\section}{\large\bfseries}

\renewcommand{\footnoterule}{%
  \kern -3pt
  \hrule width \textwidth height 1pt
  \kern 2pt
}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

% This is the color used for MATLAB comments below
\definecolor{MyDarkGreen}{rgb}{0.0,0.4,0.0}

% For faster processing, load Matlab syntax for listings
\lstloadlanguages{Matlab}%
\lstset{language=Matlab,                        % Use MATLAB
        frame=single,                           % Single frame around code
        basicstyle=\small\ttfamily,             % Use small true type font
        keywordstyle=[1]\color{Blue}\bfseries,        % MATLAB functions bold and blue
        keywordstyle=[2]\color{Purple},         % MATLAB function arguments purple
        keywordstyle=[3]\color{Blue}\underbar,  % User functions underlined and blue
        identifierstyle=,                       % Nothing special about identifiers
                                                % Comments small dark green courier
        commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small,
        stringstyle=\color{Purple},             % Strings are purple
        showstringspaces=false,                 % Don't put marks in string spaces
        tabsize=5,                              % 5 spaces per tab
        %
        %%% Put standard MATLAB functions not included in the default
        %%% language here
        morekeywords={xlim,ylim,var,alpha,factorial,poissrnd,normpdf,normcdf, quadprog, fmincon, fminunc},
        %
        %%% Put MATLAB function parameters here
        morekeywords=[2]{on, off, interp},
        %
        %%% Put user defined functions here
        morekeywords=[3]{confunNeqG},
        %
        morecomment=[l][\color{Blue}]{...},     % Line continuation (...) like blue comment
        inputencoding=latin1
        }
        \lstset{literate=%
        {Ö}{{\"O}}1
        {Ä}{{\"A}}1
        {Ü}{{\"U}}1
        {ß}{{\ss}}1
        {ü}{{\"u}}1
        {ä}{{\"a}}1
        {ö}{{\"o}}1
      }

\begin{document}

\begin{center}
    \vspace*{2em}
    \normalsize 4. Projekt\\
    \vspace*{1em}
    %\normalsize \textbf{\textit{Penalty-Verfahren \& SQP-Verfahren}}\\
    \vspace*{4em}
    \normalsize im Fach\\
    \vspace*{1em}
    \large Numerische Optimierung\\
    \vspace*{30em}
    \normalsize Juli 2020\\
    \vspace*{1em}
    \normalsize Maximilian Gaul
\end{center}

\thispagestyle{empty}

\newpage

\subsubsection{Aufgabe 1}
Siehe \lstinline[basicstyle=\ttfamily\color{black}]|GlobNewton.m|.

\subsubsection{Aufgabe 2}
Siehe auch \lstinline[basicstyle=\ttfamily\color{black}]|Projekt_4.m|.\par

Für die Himmelblau-Funktion

$$ f(x_1, x_2) = (x_1^2 + x_2 - 11)^2 + (x_1 + x_2^2 - 7)^2 $$

gelten folgende Ableitungen

$$ \nabla f(x_1, x_2) = \begin{bmatrix}2(x_1^2 + x_2 - 11)\cdot 2x_1 + 2 (x_1 + x_2^2 - 7)\\2(x_1^2 + x_2 - 11) + 2(x_1 + x_2^2 - 7)\cdot 2x_2\end{bmatrix} $$
$$ H_f(x_1, x_2) = \begin{bmatrix}4(x_1^2 + x_2 - 11) + 8x_1^2 & 4x_1 + 4x_2\\4x_1 + 4x_2 & 4 (x_1 + x_2^2 - 7) + 8x_2^2\end{bmatrix} $$

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|r}
    \hline
    \textbf{Schritt} & \textbf{x} & \textbf{$f(x)$}\\
    \hline
    1 & $[0.00, 0.00]^T$ & 170.0\\
    2 & $[1.75, 2.75]^T$ & 32.26\\
    3 & $[3.76, 2.22]^T$ & 31.69\\
    4 & $[3.19, 1.96]^T$ & 1.31\\
    5 & $[3.02, 1.99]^T$ & 0.01\\
    $\vdots$ & $\vdots$ & $\vdots$\\
    15 & $[3.00, 2.00]^T$ & $1.10 \cdot 10^{-26}$\\
    \hline
  \end{tabular}
  \caption{Verlauf von \lstinline[basicstyle=\ttfamily\color{black}]|GlobNewton| für $f$ bei einer Genauigkeit von $10^{-12}$}
  \label{convHimmel1}
\end{figure}

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|r}
    \hline
    \textbf{Schritt} & \textbf{x} & \textbf{$f(x)$}\\
    \hline
    1 & $[-1.20, 1.00]^T$ & 125.11\\
    2 & $[-2.87, 3.87]^T$ & 27.30\\
    3 & $[-2.80, 3.29]^T$ & 1.05\\
    4 & $[-2.80, 3.14]^T$ & 0.00\\
    5 & $[-2.81, 3.13]^T$ & $9.83 \cdot 10^{-7}$\\
    $\vdots$ & $\vdots$ & $\vdots$\\
    12 & $[-2.81, 3.13]^T$ & $4.10 \cdot 10^{-29}$\\
    \hline
  \end{tabular}
  \caption{Verlauf von \lstinline[basicstyle=\ttfamily\color{black}]|GlobNewton| für $f$ bei einer Genauigkeit von $10^{-12}$}
  \label{convHimmel2}
\end{figure}

Für die 2D Rosenbrock-Funktion

$$ g(x_1, x_2) = 100(x_2 - x_1^2)^2 + (1 - x_1)^2 $$

gelten die Ableitungen

$$ \nabla g(x_1, x_2) = \begin{bmatrix} 400x_1^3 - 400x_1x_2 + 2x_1 - 2\\200(x_2 - x_1^2)\end{bmatrix} $$
$$ H_g(x_1, x_2) = \begin{bmatrix} 800x_1^2 - 400(x_2-x_1^2) + 2 & -400x_1\\-400x_1 & 200 \end{bmatrix} $$

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|r}
    \hline
    \textbf{Schritt} & \textbf{x} & \textbf{$g(x)$}\\
    \hline
    1 & $[0.00, 0.00]^T$ & 1.00\\
    2 & $[0.25, 0.00]^T$ & 0.95\\
    3 & $[0.31, 0.09]^T$ & 0.48\\
    4 & $[0.52, 0.22]^T$ & 0.46\\
    5 & $[0.57, 0.32]^T$ & 0.19\\
    $\vdots$ & $\vdots$ & $\vdots$\\
    15 & $[1.00, 1.00]^T$ & $8.21 \cdot 10^{-28}$\\
    \hline
  \end{tabular}
  \caption{Verlauf von \lstinline[basicstyle=\ttfamily\color{black}]|GlobNewton| für $g$ bei einer Genauigkeit von $10^{-12}$}
\end{figure}

\begin{figure}[H]
  \centering
  \def\arraystretch{1.25}
  \begin{tabular}{l|c|r}
    \hline
    \textbf{Schritt} & \textbf{x} & \textbf{$g(x)$}\\
    \hline
    1 & $[-1.20, 1.00]^T$ & 24.20\\
    2 & $[-1.18, 1.38]^T$ & 4.73\\
    3 & $[-0.93, 0.81]^T$ & 4.09\\
    4 & $[-0.78, 0.59]^T$ & 3.23\\
    5 & $[-0.46, 0.11]^T$ & 3.21\\
    $\vdots$ & $\vdots$ & $\vdots$\\
    12 & $[1.00, 1.00]^T$ & $4.93 \cdot 10^{-28}$\\
    \hline
  \end{tabular}
  \caption{Verlauf von \lstinline[basicstyle=\ttfamily\color{black}]|GlobNewton| für $g$ bei einer Genauigkeit von $10^{-12}$}
\end{figure}

\subsubsection{Aufgabe 3}
Die Hesse-Matrizen der beiden Funktionen $f$ und $g$ ist stetig und kontinuierlich, d.h. es kann in beiden Fällen vom
Zutreffen der Lipschitz-Bedingung

$$ ||H(x) - H(y)|| \leq L||x-y|| \forall x,y \in R^n$$

ausgegangen werden. Weiterhin enthalten beide Funktionen keine mehrfachen Nullstellen durch die das Newton-Verfahren
gebremst werden könnte. Aufgrundessen konvergieren beide Funktionen lokal-quadratisch. Global gesehen konvergiert
das Newton-Verfahren je nach Schrittweitenstrategie (ob effizient oder nicht) entweder gar nicht aufgrund zu kleiner
Schrittweiten (z.B. normales Armijo-Verfahren) oder zumindest nur superlinearer. Die lokale quadratische Konvergenz
der Himmelblau-Funktion kann man in (\ref{convHimmel1}) und (\ref{convHimmel2}) zwischen Schritt 3 und 4 bzw. 2 und 3
gut erkennen.\par
Bei Quasi-Newton-Verfahren mit approximierter Hesse-Matrix und effizienter Schrittweitenstrategie kann man global gesehen
von einer superlinearen Konvergenz für beide Funktionen $f$ und $g$ ausgehen. Broyden \textit{et al.} haben 1973
in \textit{On the Local and Superlinear Convergence of Quasi-Newton Methods} gezeigt, dass die Fehler in der Approximation
von $H_k$ begrenzt sind und sich nicht unbeschränkt erhöhen.\par
Weiterhin sind beide Funktionen nicht quadratischer Natur ansonsten könnte die Schrittweite ggf. exakt berechnet werden.

\subsubsection{Aufgabe 4}

\end{document}